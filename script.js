// Инициализация Telegram Web Apps
const tg = window.Telegram.WebApp;
tg.ready();

// Проверка загрузки Telegram Web App API
if (!window.Telegram || !window.Telegram.WebApp) {
    console.error("Telegram Web App API не загружен");
} else {
    console.log("Telegram Web App API успешно загружен");
}

// Глобальные переменные
let userData = {
    height: 0,
    weight: 0,
    goal: '',
    allergies: [],
    points: 0,
    achievements: [],
    water: 0,
    steps: 0,
    weightHistory: [70], // Пример данных для графика
    dailyCalories: 0,
    dailyMacros: { protein: 0, fat: 0, carbs: 0 },
    menu: []
};

// Список блюд (вставляем массив dishes из предыдущего шага)
const dishes = [
    {
        name: "Омлет с овощами",
        ingredients: "Яйца (3 шт), Помидоры (50 г), Перец (50 г), Зелень",
        prices: { "Пятёрочка": 120, "Магнит": 130, "Лента": 115 },
        weight: 200,
        calories: 240,
        protein: 18,
        fat: 15,
        carbs: 5,
        image_url: "https://example.com/omelette.jpg",
        mealType: "завтрак",
        recipe: "1. Нарежьте помидоры, перец и зелень.\n2. Взбейте яйца в миске, добавьте соль и перец по вкусу.\n3. Обжарьте овощи на сковороде с небольшим количеством масла 2-3 минуты.\n4. Залейте овощи яичной смесью и готовьте на среднем огне 5-7 минут до готовности.",
        allergens: ["Яйца"]
    },
    {
        name: "Греческий йогурт с фруктами",
        ingredients: "Греческий йогурт (150 г), Ягоды (50 г), Мед (10 г)",
        prices: { "Пятёрочка": 100, "Магнит": 110, "Лента": 95 },
        weight: 210,
        calories: 180,
        protein: 10,
        fat: 5,
        carbs: 20,
        image_url: "https://example.com/yogurt.jpg",
        mealType: "завтрак",
        recipe: "1. Положите греческий йогурт в миску.\n2. Добавьте сверху ягоды (например, малину или чернику).\n3. Полейте мёдом и подавайте.",
        allergens: ["Молоко"]
    },
    {
        name: "Овсянка с бананом и орехами",
        ingredients: "Овсяные хлопья (50 г), Банан (100 г), Молоко (150 мл), Миндаль (10 г)",
        prices: { "Пятёрочка": 110, "Магнит": 115, "Лента": 105 },
        weight: 310,
        calories: 350,
        protein: 12,
        fat: 8,
        carbs: 55,
        image_url: "https://example.com/oatmeal.jpg",
        mealType: "завтрак",
        recipe: "1. Вскипятите молоко в кастрюле.\n2. Добавьте овсяные хлопья и варите на медленном огне 5-7 минут, помешивая.\n3. Нарежьте банан кружочками.\n4. Выложите овсянку в миску, добавьте банан и миндаль сверху.",
        allergens: ["Молоко", "Орехи", "Глютен"]
    },
    {
        name: "Тост с авокадо и яйцом",
        ingredients: "Хлеб цельнозерновой (1 ломтик), Авокадо (50 г), Яйцо (1 шт)",
        prices: { "Пятёрочка": 90, "Магнит": 95, "Лента": 85 },
        weight: 150,
        calories: 220,
        protein: 8,
        fat: 15,
        carbs: 15,
        image_url: "https://example.com/avocado_toast.jpg",
        mealType: "завтрак",
        recipe: "1. Поджарьте ломтик хлеба в тостере.\n2. Разомните авокадо вилкой и намажьте на тост.\n3. Сварите яйцо вкрутую или приготовьте яйцо-пашот.\n4. Выложите яйцо на авокадо, посыпьте солью и перцем.",
        allergens: ["Яйца", "Глютен"]
    },
    {
        name: "Вегетарианский омлет с тофу",
        ingredients: "Тофу (100 г), Помидоры (50 г), Шпинат (30 г), Куркума (2 г)",
        prices: { "Пятёрочка": 110, "Магнит": 120, "Лента": 105 },
        weight: 180,
        calories: 150,
        protein: 12,
        fat: 8,
        carbs: 5,
        image_url: "https://example.com/tofu_omelette.jpg",
        mealType: "завтрак",
        recipe: "1. Измельчите тофу в блендере до состояния пасты.\n2. Нарежьте помидоры и шпинат.\n3. Обжарьте овощи на сковороде 2-3 минуты.\n4. Добавьте тофу, куркуму, соль и перец, готовьте 5-7 минут, помешивая.",
        allergens: ["Соя"]
    },
    {
        name: "Смузи с ягодами и шпинатом",
        ingredients: "Ягоды (100 г), Шпинат (30 г), Банан (50 г), Миндальное молоко (150 мл)",
        prices: { "Пятёрочка": 130, "Магнит": 140, "Лента": 125 },
        weight: 330,
        calories: 180,
        protein: 3,
        fat: 2,
        carbs: 35,
        image_url: "https://example.com/berry_smoothie.jpg",
        mealType: "завтрак",
        recipe: "1. Положите ягоды, шпинат, банан и миндальное молоко в блендер.\n2. Взбейте до однородной консистенции.\n3. Перелейте в стакан и подавайте.",
        allergens: ["Орехи"]
    },
    {
        name: "Панкейки с ягодами",
        ingredients: "Мука (50 г), Яйцо (1 шт), Молоко (100 мл), Ягоды (50 г), Мед (10 г)",
        prices: { "Пятёрочка": 120, "Магнит": 130, "Лента": 115 },
        weight: 210,
        calories: 300,
        protein: 8,
        fat: 10,
        carbs: 45,
        image_url: "https://example.com/pancakes.jpg",
        mealType: "завтрак",
        recipe: "1. Смешайте муку, яйцо и молоко до однородного теста.\n2. Разогрейте сковороду и слегка смажьте маслом.\n3. Вылейте тесто небольшими порциями, жарьте по 2-3 минуты с каждой стороны.\n4. Подавайте с ягодами и мёдом.",
        allergens: ["Глютен", "Яйца", "Молоко"]
    },
    {
        name: "Сырники с изюмом",
        ingredients: "Творог (150 г), Яйцо (1 шт), Мука (20 г), Изюм (20 г)",
        prices: { "Пятёрочка": 100, "Магнит": 110, "Лента": 95 },
        weight: 190,
        calories: 280,
        protein: 15,
        fat: 10,
        carbs: 30,
        image_url: "https://example.com/cheese_pancakes.jpg",
        mealType: "завтрак",
        recipe: "1. Смешайте творог, яйцо, муку и изюм до однородной массы.\n2. Сформируйте небольшие лепёшки.\n3. Обжарьте сырники на сковороде с небольшим количеством масла по 3-4 минуты с каждой стороны.\n4. Подавайте с мёдом или сметаной.",
        allergens: ["Молоко", "Яйца", "Глютен"]
    },
    {
        name: "Борщ с мясом",
        ingredients: "Свекла (100 г), Картофель (100 г), Мясо (150 г), Капуста (50 г), Сметана (20 г)",
        prices: { "Пятёрочка": 180, "Магнит": 190, "Лента": 175 },
        weight: 400,
        calories: 350,
        protein: 20,
        fat: 15,
        carbs: 30,
        image_url: "https://example.com/borscht.jpg",
        mealType: "суп",
        recipe: "1. Сварите мясо в воде до готовности, снимите пену.\n2. Добавьте нарезанные свеклу, картофель и капусту, варите 20 минут.\n3. Приправьте солью, перцем и добавьте сметану при подаче.",
        allergens: ["Молоко"]
    },
    {
        name: "Крем-суп из брокколи",
        ingredients: "Брокколи (150 г), Картофель (50 г), Сливки (50 мл), Лук (30 г)",
        prices: { "Пятёрочка": 140, "Магнит": 150, "Лента": 135 },
        weight: 300,
        calories: 200,
        protein: 5,
        fat: 10,
        carbs: 20,
        image_url: "https://example.com/broccoli_soup.jpg",
        mealType: "суп",
        recipe: "1. Обжарьте лук на сковороде до мягкости.\n2. Добавьте брокколи и картофель, залейте водой и варите 15 минут.\n3. Добавьте сливки, соль и взбейте блендером до кремовой текстуры.",
        allergens: ["Молоко"]
    },
    {
        name: "Тыквенный суп-пюре",
        ingredients: "Тыква (150 г), Морковь (50 г), Кокосовое молоко (50 мл), Имбирь (5 г)",
        prices: { "Пятёрочка": 120, "Магнит": 130, "Лента": 115 },
        weight: 300,
        calories: 150,
        protein: 3,
        fat: 5,
        carbs: 20,
        image_url: "https://example.com/pumpkin_soup.jpg",
        mealType: "суп",
        recipe: "1. Нарежьте тыкву и морковь, варите в воде 20 минут.\n2. Добавьте кокосовое молоко и имбирь, варите ещё 5 минут.\n3. Взбейте блендером до состояния пюре.",
        allergens: ["Орехи"]
    },
    {
        name: "Грибной суп с перловкой",
        ingredients: "Грибы (100 г), Перловка (50 г), Картофель (50 г), Лук (30 г)",
        prices: { "Пятёрочка": 130, "Магнит": 140, "Лента": 125 },
        weight: 350,
        calories: 180,
        protein: 5,
        fat: 3,
        carbs: 30,
        image_url: "https://example.com/mushroom_soup.jpg",
        mealType: "суп",
        recipe: "1. Замочите перловку на 1 час, затем сварите до готовности.\n2. Обжарьте лук и грибы на сковороде.\n3. Добавьте картофель, перловку и грибы в кипящую воду, варите 15 минут.\n4. Приправьте солью и перцем.",
        allergens: ["Глютен"]
    },
    {
        name: "Том Ям с креветками",
        ingredients: "Креветки (100 г), Кокосовое молоко (100 мл), Лемонграсс (10 г), Чили (5 г)",
        prices: { "Пятёрочка": 250, "Магнит": 260, "Лента": 240 },
        weight: 350,
        calories: 300,
        protein: 20,
        fat: 15,
        carbs: 15,
        image_url: "https://example.com/tom_yam.jpg",
        mealType: "суп",
        recipe: "1. Вскипятите воду, добавьте лемонграсс и чили, варите 5 минут.\n2. Добавьте кокосовое молоко и креветки, варите ещё 5 минут.\n3. Приправьте солью и соком лайма.",
        allergens: ["Морепродукты", "Орехи"]
    },
    {
        name: "Куриная грудка с гречкой",
        ingredients: "Куриная грудка (150 г), Гречка (100 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 200, "Магнит": 210, "Лента": 195 },
        weight: 350,
        calories: 400,
        protein: 35,
        fat: 10,
        carbs: 40,
        image_url: "https://example.com/chicken_buckwheat.jpg",
        mealType: "горячее",
        recipe: "1. Сварите гречку в подсоленной воде 15 минут.\n2. Обжарьте куриную грудку на оливковом масле по 5 минут с каждой стороны.\n3. Подавайте курицу с гречкой.",
        allergens: []
    },
    {
        name: "Лосось с киноа и овощами",
        ingredients: "Лосось (150 г), Киноа (100 г), Брокколи (50 г), Морковь (50 г)",
        prices: { "Пятёрочка": 300, "Магнит": 310, "Лента": 290 },
        weight: 350,
        calories: 450,
        protein: 35,
        fat: 20,
        carbs: 35,
        image_url: "https://example.com/salmon_quinoa.jpg",
        mealType: "горячее",
        recipe: "1. Сварите киноа в подсоленной воде 15 минут.\n2. Запеките лосось в духовке при 180°C 15 минут.\n3. Отварите брокколи и морковь на пару.\n4. Подавайте лосось с киноа и овощами.",
        allergens: ["Рыба"]
    },
    {
        name: "Фалафель с хумусом и овощами",
        ingredients: "Нут (100 г), Тахини (20 г), Овощи (100 г), Специи",
        prices: { "Пятёрочка": 160, "Магнит": 170, "Лента": 155 },
        weight: 280,
        calories: 350,
        protein: 15,
        fat: 15,
        carbs: 40,
        image_url: "https://example.com/falafel_hummus.jpg",
        mealType: "горячее",
        recipe: "1. Замочите нут на ночь, затем измельчите в блендере с тахини и специями.\n2. Сформируйте шарики и обжарьте во фритюре 5-7 минут.\n3. Нарежьте овощи (помидоры, огурцы).\n4. Подавайте фалафель с хумусом и овощами.",
        allergens: ["Соя"]
    },
    {
        name: "Паста с овощами и песто",
        ingredients: "Паста цельнозерновая (100 г), Базилик (20 г), Оливковое масло (10 г), Кабачок (50 г)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 280,
        calories: 380,
        protein: 12,
        fat: 15,
        carbs: 50,
        image_url: "https://example.com/pasta_pesto.jpg",
        mealType: "горячее",
        recipe: "1. Сварите пасту в подсоленной воде до состояния аль денте.\n2. Обжарьте кабачок на оливковом масле 5 минут.\n3. Смешайте базилик, оливковое масло и соль в блендере, чтобы приготовить песто.\n4. Смешайте пасту с песто и кабачком.",
        allergens: ["Глютен"]
    },
    {
        name: "Ризотто с грибами",
        ingredients: "Рис арборио (100 г), Грибы (100 г), Пармезан (20 г), Лук (30 г)",
        prices: { "Пятёрочка": 200, "Магнит": 210, "Лента": 195 },
        weight: 300,
        calories: 400,
        protein: 10,
        fat: 15,
        carbs: 60,
        image_url: "https://example.com/mushroom_risotto.jpg",
        mealType: "горячее",
        recipe: "1. Обжарьте лук и грибы на сковороде.\n2. Добавьте рис арборио и обжарьте 2 минуты.\n3. Постепенно вливайте горячий бульон, помешивая, пока рис не станет мягким (около 20 минут).\n4. Добавьте пармезан и перемешайте.",
        allergens: ["Молоко"]
    },
    {
        name: "Стейк с картофелем и розмарином",
        ingredients: "Говядина (150 г), Картофель (100 г), Розмарин (5 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 350, "Магнит": 360, "Лента": 340 },
        weight: 350,
        calories: 500,
        protein: 40,
        fat: 25,
        carbs: 35,
        image_url: "https://example.com/steak_potato.jpg",
        mealType: "горячее",
        recipe: "1. Замаринуйте стейк в оливковом масле, розмарине, соли и перце на 30 минут.\n2. Нарежьте картофель дольками, смешайте с маслом и розмарином, запекайте при 200°C 25 минут.\n3. Обжарьте стейк на гриле по 3-4 минуты с каждой стороны.\n4. Подавайте стейк с картофелем.",
        allergens: []
    },
    {
        name: "Лазанья с мясом",
        ingredients: "Листы лазаньи (100 г), Фарш (150 г), Томатный соус (50 г), Сыр (50 г)",
        prices: { "Пятёрочка": 300, "Магнит": 310, "Лента": 290 },
        weight: 350,
        calories: 550,
        protein: 30,
        fat: 25,
        carbs: 50,
        image_url: "https://example.com/lasagna.jpg",
        mealType: "горячее",
        recipe: "1. Обжарьте фарш с томатным соусом.\n2. Выложите слой листов лазаньи в форму, затем слой фарша, повторите.\n3. Посыпьте сыром сверху.\n4. Запекайте при 180°C 30 минут.",
        allergens: ["Глютен", "Молоко"]
    },
    {
        name: "Вегетарианский карри с нутом",
        ingredients: "Нут (100 г), Кокосовое молоко (100 мл), Томаты (50 г), Специи",
        prices: { "Пятёрочка": 180, "Магнит": 190, "Лента": 175 },
        weight: 300,
        calories: 350,
        protein: 15,
        fat: 15,
        carbs: 40,
        image_url: "https://example.com/veg_curry.jpg",
        mealType: "горячее",
        recipe: "1. Замочите нут на ночь, затем сварите до готовности.\n2. Обжарьте специи (кумин, куркуму) на сковороде.\n3. Добавьте томаты и кокосовое молоко, тушите 10 минут.\n4. Добавьте нут и готовьте ещё 5 минут.",
        allergens: ["Орехи"]
    },
    {
        name: "Салат Цезарь с курицей",
        ingredients: "Куриная грудка (100 г), Салат (50 г), Сухарики (20 г), Соус (20 г), Пармезан (10 г)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 250,
        calories: 300,
        protein: 20,
        fat: 15,
        carbs: 15,
        image_url: "https://example.com/caesar_salad.jpg",
        mealType: "салат",
        recipe: "1. Обжарьте куриную грудку до готовности, нарежьте ломтиками.\n2. Порвите салат на кусочки, добавьте сухарики.\n3. Полейте соусом Цезарь, посыпьте пармезаном.\n4. Выложите курицу сверху.",
        allergens: ["Глютен", "Молоко"]
    },
    {
        name: "Греческий салат",
        ingredients: "Помидоры (100 г), Огурцы (100 г), Фета (50 г), Оливки (30 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 130, "Магнит": 140, "Лента": 125 },
        weight: 290,
        calories: 200,
        protein: 8,
        fat: 15,
        carbs: 10,
        image_url: "https://example.com/greek_salad.jpg",
        mealType: "салат",
        recipe: "1. Нарежьте помидоры, огурцы и фету кубиками.\n2. Добавьте оливки.\n3. Полейте оливковым маслом, посыпьте солью и перцем.\n4. Перемешайте и подавайте.",
        allergens: ["Молоко"]
    },
    {
        name: "Салат с киноа и авокадо",
        ingredients: "Киноа (50 г), Авокадо (50 г), Помидоры (50 г), Лимонный сок (10 мл)",
        prices: { "Пятёрочка": 140, "Магнит": 150, "Лента": 135 },
        weight: 200,
        calories: 220,
        protein: 5,
        fat: 12,
        carbs: 25,
        image_url: "https://example.com/quinoa_avocado_salad.jpg",
        mealType: "салат",
        recipe: "1. Сварите киноа в подсоленной воде 15 минут.\n2. Нарежьте авокадо и помидоры кубиками.\n3. Смешайте киноа, авокадо и помидоры, полейте лимонным соком.\n4. Перемешайте и подавайте.",
        allergens: []
    },
    {
        name: "Салат с тунцом и яйцом",
        ingredients: "Тунец консервированный (100 г), Яйцо (1 шт), Салат (50 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 160, "Магнит": 170, "Лента": 155 },
        weight: 220,
        calories: 250,
        protein: 20,
        fat: 15,
        carbs: 5,
        image_url: "https://example.com/tuna_salad.jpg",
        mealType: "салат",
        recipe: "1. Сварите яйцо вкрутую, нарежьте дольками.\n2. Порвите салат на кусочки.\n3. Добавьте тунец и яйцо, полейте оливковым маслом.\n4. Перемешайте и подавайте.",
        allergens: ["Рыба", "Яйца"]
    },
    {
        name: "Капрезе",
        ingredients: "Моцарелла (100 г), Помидоры (100 г), Базилик (10 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 220,
        calories: 250,
        protein: 10,
        fat: 20,
        carbs: 5,
        image_url: "https://example.com/caprese.jpg",
        mealType: "салат",
        recipe: "1. Нарежьте моцареллу и помидоры кружочками.\n2. Выложите их поочерёдно на тарелку.\n3. Добавьте листья базилика, полейте оливковым маслом.\n4. Посыпьте солью и перцем.",
        allergens: ["Молоко"]
    },
    {
        name: "Рыба на пару с овощами",
        ingredients: "Филе рыбы (150 г), Брокколи (100 г), Морковь (50 г)",
        prices: { "Пятёрочка": 220, "Магнит": 230, "Лента": 215 },
        weight: 300,
        calories: 250,
        protein: 30,
        fat: 5,
        carbs: 10,
        image_url: "https://example.com/steamed_fish.jpg",
        mealType: "ужин",
        recipe: "1. Приготовьте рыбу и овощи на пару 15-20 минут.\n2. Посыпьте солью и перцем.\n3. Подавайте с долькой лимона.",
        allergens: ["Рыба"]
    },
    {
        name: "Творог с мёдом",
        ingredients: "Творог (150 г), Мёд (20 г)",
        prices: { "Пятёрочка": 80, "Магнит": 85, "Лента": 75 },
        weight: 170,
        calories: 200,
        protein: 20,
        fat: 5,
        carbs: 15,
        image_url: "https://example.com/cottage_cheese.jpg",
        mealType: "ужин",
        recipe: "1. Положите творог в миску.\n2. Полейте мёдом.\n3. Перемешайте и подавайте.",
        allergens: ["Молоко"]
    },
    {
        name: "Запечённая курица с овощами",
        ingredients: "Куриное филе (150 г), Кабачок (50 г), Перец (50 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 180, "Магнит": 190, "Лента": 175 },
        weight: 260,
        calories: 300,
        protein: 30,
        fat: 10,
        carbs: 10,
        image_url: "https://example.com/baked_chicken.jpg",
        mealType: "ужин",
        recipe: "1. Замаринуйте курицу в оливковом масле, соли и перце.\n2. Нарежьте кабачок и перец.\n3. Выложите курицу и овощи на противень.\n4. Запекайте при 180°C 30 минут.",
        allergens: []
    },
    {
        name: "Запечённые овощи с тофу",
        ingredients: "Тофу (100 г), Кабачок (50 г), Баклажан (50 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 210,
        calories: 200,
        protein: 10,
        fat: 10,
        carbs: 15,
        image_url: "https://example.com/baked_veggies_tofu.jpg",
        mealType: "ужин",
        recipe: "1. Нарежьте тофу, кабачок и баклажан кубиками.\n2. Смешайте с оливковым маслом, солью и перцем.\n3. Запекайте при 200°C 25 минут.\n4. Подавайте горячим.",
        allergens: ["Соя"]
    },
    {
        name: "Овощной рататуй",
        ingredients: "Баклажан (100 г), Кабачок (100 г), Помидоры (100 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 140, "Магнит": 150, "Лента": 135 },
        weight: 310,
        calories: 150,
        protein: 3,
        fat: 5,
        carbs: 20,
        image_url: "https://example.com/ratatouille.jpg",
        mealType: "ужин",
        recipe: "1. Нарежьте баклажан, кабачок и помидоры кружочками.\n2. Выложите овощи в форму по спирали.\n3. Полейте оливковым маслом, посыпьте солью и перцем.\n4. Запекайте при 180°C 40 минут.",
        allergens: []
    },
    {
        name: "Яблоко",
        ingredients: "Яблоко (200 г)",
        prices: { "Пятёрочка": 30, "Магнит": 35, "Лента": 28 },
        weight: 200,
        calories: 100,
        protein: 0,
        fat: 0,
        carbs: 25,
        image_url: "https://example.com/apple.jpg",
        mealType: "перекус",
        recipe: "1. Помойте яблоко.\n2. Ешьте свежим или нарежьте дольками.",
        allergens: []
    },
    {
        name: "Орехи",
        ingredients: "Миндаль (30 г)",
        prices: { "Пятёрочка": 50, "Магнит": 55, "Лента": 48 },
        weight: 30,
        calories: 180,
        protein: 6,
        fat: 15,
        carbs: 5,
        image_url: "https://example.com/nuts.jpg",
        mealType: "перекус",
        recipe: "1. Возьмите горсть миндаля.\n2. Ешьте как перекус.",
        allergens: ["Орехи"]
    },
    {
        name: "Банан",
        ingredients: "Банан (120 г)",
        prices: { "Пятёрочка": 25, "Магнит": 30, "Лента": 22 },
        weight: 120,
        calories: 90,
        protein: 1,
        fat: 0,
        carbs: 22,
        image_url: "https://example.com/banana.jpg",
        mealType: "перекус",
        recipe: "1. Очистите банан.\n2. Ешьте свежим.",
        allergens: []
    },
    {
        name: "Йогурт натуральный",
        ingredients: "Йогурт натуральный (150 г)",
        prices: { "Пятёрочка": 40, "Магнит": 45, "Лента": 38 },
        weight: 150,
        calories: 90,
        protein: 5,
        fat: 3,
        carbs: 8,
        image_url: "https://example.com/yogurt_natural.jpg",
        mealType: "перекус",
        recipe: "1. Откройте упаковку йогурта.\n2. Ешьте ложкой.",
        allergens: ["Молоко"]
    },
    {
        name: "Протеиновый батончик",
        ingredients: "Протеиновый батончик (50 г)",
        prices: { "Пятёрочка": 70, "Магнит": 75, "Лента": 65 },
        weight: 50,
        calories: 200,
        protein: 15,
        fat: 8,
        carbs: 15,
        image_url: "https://example.com/protein_bar.jpg",
        mealType: "перекус",
        recipe: "1. Разверните протеиновый батончик.\n2. Ешьте как перекус.",
        allergens: ["Орехи", "Молоко"]
    },
    {
        name: "Морковные палочки с хумусом",
        ingredients: "Морковь (100 г), Хумус (50 г)",
        prices: { "Пятёрочка": 60, "Магнит": 65, "Лента": 55 },
        weight: 150,
        calories: 120,
        protein: 3,
        fat: 5,
        carbs: 15,
        image_url: "https://example.com/carrot_hummus.jpg",
        mealType: "перекус",
        recipe: "1. Нарежьте морковь на палочки.\n2. Подавайте с хумусом для макания.",
        allergens: ["Соя"]
    },
    {
        name: "Горсть винограда",
        ingredients: "Виноград (100 г)",
        prices: { "Пятёрочка": 50, "Магнит": 55, "Лента": 45 },
        weight: 100,
        calories: 70,
        protein: 1,
        fat: 0,
        carbs: 18,
        image_url: "https://example.com/grapes.jpg",
        mealType: "перекус",
        recipe: "1. Помойте виноград.\n2. Ешьте свежим.",
        allergens: []
    },
    {
        name: "Сельдерей с арахисовым маслом",
        ingredients: "Сельдерей (100 г), Арахисовое масло (20 г)",
        prices: { "Пятёрочка": 70, "Магнит": 75, "Лента": 65 },
        weight: 120,
        calories: 150,
        protein: 4,
        fat: 12,
        carbs: 5,
        image_url: "https://example.com/celery_peanut_butter.jpg",
        mealType: "перекус",
        recipe: "1. Нарежьте сельдерей на палочки.\n2. Намажьте арахисовое масло на сельдерей.\n3. Ешьте как перекус.",
        allergens: ["Орехи"]
    },
    {
        name: "Чиа-пудинг с ягодами",
        ingredients: "Семена чиа (30 г), Кокосовое молоко (150 мл), Ягоды (50 г)",
        prices: { "Пятёрочка": 100, "Магнит": 110, "Лента": 95 },
        weight: 230,
        calories: 200,
        protein: 5,
        fat: 10,
        carbs: 20,
        image_url: "https://example.com/chia_pudding.jpg",
        mealType: "десерт",
        recipe: "1. Смешайте семена чиа с кокосовым молоком, оставьте на ночь в холодильнике.\n2. Утром добавьте ягоды сверху.\n3. Перемешайте и подавайте.",
        allergens: ["Орехи"]
    },
    {
        name: "Запечённое яблоко с мёдом и корицей",
        ingredients: "Яблоко (200 г), Мёд (10 г), Корица (2 г)",
        prices: { "Пятёрочка": 50, "Магнит": 55, "Лента": 45 },
        weight: 210,
        calories: 150,
        protein: 1,
        fat: 0,
        carbs: 35,
        image_url: "https://example.com/baked_apple.jpg",
        mealType: "десерт",
        recipe: "1. Разрежьте яблоко пополам, удалите сердцевину.\n2. Полейте мёдом и посыпьте корицей.\n3. Запекайте при 180°C 20 минут.\n4. Подавайте тёплым.",
        allergens: []
    },
    {
        name: "Фруктовый салат",
        ingredients: "Яблоко (50 г), Банан (50 г), Апельсин (50 г), Йогурт (50 г)",
        prices: { "Пятёрочка": 80, "Магнит": 85, "Лента": 75 },
        weight: 200,
        calories: 150,
        protein: 3,
        fat: 1,
        carbs: 30,
        image_url: "https://example.com/fruit_salad.jpg",
        mealType: "десерт",
        recipe: "1. Нарежьте яблоко, банан и апельсин кубиками.\n2. Смешайте фрукты в миске.\n3. Добавьте йогурт и перемешайте.\n4. Подавайте охлаждённым.",
        allergens: ["Молоко"]
    },
    {
        name: "Мороженое из банана",
        ingredients: "Банан (150 г), Какао (10 г)",
        prices: { "Пятёрочка": 50, "Магнит": 55, "Лента": 45 },
        weight: 160,
        calories: 120,
        protein: 2,
        fat: 1,
        carbs: 25,
        image_url: "https://example.com/banana_ice_cream.jpg",
        mealType: "десерт",
        recipe: "1. Заморозьте банан на 2 часа.\n2. Измельчите замороженный банан в блендере до кремовой текстуры.\n3. Добавьте какао и взбейте ещё раз.\n4. Подавайте сразу.",
        allergens: []
    },
    {
        name: "Тирамису легкий",
        ingredients: "Савоярди (50 г), Маскарпоне (50 г), Кофе (50 мл), Какао (5 г)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 150,
        calories: 300,
        protein: 5,
        fat: 15,
        carbs: 35,
        image_url: "https://example.com/tiramisu.jpg",
        mealType: "десерт",
        recipe: "1. Сварите кофе и дайте ему остыть.\n2. Обмакните савоярди в кофе и выложите в форму.\n3. Смешайте маскарпоне с небольшим количеством кофе, выложите сверху.\n4. Посыпьте какао и охладите 1 час.",
        allergens: ["Глютен", "Молоко"]
    },
    {
        name: "Зеленый чай с мятой",
        ingredients: "Зеленый чай (1 пакетик), Мята (5 г), Вода (200 мл)",
        prices: { "Пятёрочка": 20, "Магнит": 25, "Лента": 18 },
        weight: 200,
        calories: 0,
        protein: 0,
        fat: 0,
        carbs: 0,
        image_url: "https://example.com/green_tea.jpg",
        mealType: "напиток",
        recipe: "1. Вскипятите воду.\n2. Положите пакетик зелёного чая и мяту в чашку.\n3. Залейте горячей водой и дайте настояться 3-5 минут.\n4. Пейте горячим.",
        allergens: []
    },
    {
        name: "Смузи с манго и ананасом",
        ingredients: "Манго (100 г), Ананас (100 г), Кокосовая вода (150 мл)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 350,
        calories: 200,
        protein: 2,
        fat: 1,
        carbs: 45,
        image_url: "https://example.com/mango_smoothie.jpg",
        mealType: "напиток",
        recipe: "1. Нарежьте манго и ананас кубиками.\n2. Положите фрукты и кокосовую воду в блендер.\n3. Взбейте до однородной консистенции.\n4. Перелейте в стакан и подавайте.",
        allergens: []
    },
    {
        name: "Морс из клюквы",
        ingredients: "Клюква (100 г), Вода (200 мл), Мед (10 г)",
        prices: { "Пятёрочка": 60, "Магнит": 65, "Лента": 55 },
        weight: 310,
        calories: 80,
        protein: 0,
        fat: 0,
        carbs: 20,
        image_url: "https://example.com/cranberry_mors.jpg",
        mealType: "напиток",
        recipe: "1. Раздавите клюкву, чтобы выделился сок.\n2. Залейте ягоды водой и доведите до кипения.\n3. Процедите, добавьте мёд.\n4. Охладите и подавайте.",
        allergens: []
    },
    {
        name: "Лимонный чай с имбирем",
        ingredients: "Чай черный (1 пакетик), Лимон (20 г), Имбирь (5 г), Вода (200 мл)",
        prices: { "Пятёрочка": 25, "Магнит": 30, "Лента": 20 },
        weight: 200,
        calories: 10,
        protein: 0,
        fat: 0,
        carbs: 2,
        image_url: "https://example.com/lemon_ginger_tea.jpg",
        mealType: "напиток",
        recipe: "1. Вскипятите воду.\n2. Нарежьте имбирь тонкими ломтиками.\n3. Положите чай, имбирь и лимон в чашку, залейте горячей водой.\n4. Дайте настояться 5 минут и пейте.",
        allergens: []
    },
    {
        name: "Кофе с молоком",
        ingredients: "Кофе (1 ч.л.), Молоко (50 мл), Вода (150 мл)",
        prices: { "Пятёрочка": 30, "Магнит": 35, "Лента": 28 },
        weight: 200,
        calories: 40,
        protein: 2,
        fat: 2,
        carbs: 4,
        image_url: "https://example.com/coffee_with_milk.jpg",
        mealType: "напиток",
        recipe: "1. Сварите кофе в турке или заварите растворимый.\n2. Подогрейте молоко.\n3. Смешайте кофе с молоком.\n4. Пейте горячим.",
        allergens: ["Молоко"]
    },
    {
        name: "Компот из сухофруктов",
        ingredients: "Сухофрукты (50 г), Вода (200 мл), Мед (10 г)",
        prices: { "Пятёрочка": 50, "Магнит": 55, "Лента": 45 },
        weight: 250,
        calories: 100,
        protein: 1,
        fat: 0,
        carbs: 25,
        image_url: "https://example.com/dried_fruit_compote.jpg",
        mealType: "напиток",
        recipe: "1. Замочите сухофрукты в воде на 30 минут.\n2. Доведите до кипения и варите 15 минут.\n3. Добавьте мёд, перемешайте.\n4. Охладите и подавайте.",
        allergens: []
    },
    {
        name: "Плов с курицей",
        ingredients: "Рис (100 г), Курица (150 г), Морковь (50 г), Лук (30 г), Специи",
        prices: { "Пятёрочка": 200, "Магнит": 210, "Лента": 195 },
        weight: 350,
        calories: 450,
        protein: 25,
        fat: 15,
        carbs: 50,
        image_url: "https://example.com/chicken_plov.jpg",
        mealType: "горячее",
        recipe: "1. Обжарьте курицу с луком и морковью.\n2. Добавьте рис и специи, залейте водой.\n3. Варите на медленном огне 30 минут.\n4. Перемешайте и подавайте.",
        allergens: []
    },
    {
        name: "Гречка с грибами",
        ingredients: "Гречка (100 г), Грибы (100 г), Лук (30 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 280,
        calories: 300,
        protein: 10,
        fat: 10,
        carbs: 45,
        image_url: "https://example.com/buckwheat_mushrooms.jpg",
        mealType: "горячее",
        recipe: "1. Сварите гречку в подсоленной воде 15 минут.\n2. Обжарьте грибы с луком на оливковом масле.\n3. Смешайте гречку с грибами.\n4. Подавайте горячим.",
        allergens: []
    },
    {
        name: "Котлеты из индейки с пюре",
        ingredients: "Индейка (150 г), Картофель (100 г), Молоко (50 мл), Специи",
        prices: { "Пятёрочка": 220, "Магнит": 230, "Лента": 215 },
        weight: 350,
        calories: 400,
        protein: 30,
        fat: 15,
        carbs: 35,
        image_url: "https://example.com/turkey_cutlets.jpg",
        mealType: "горячее",
        recipe: "1. Измельчите индейку в фарш, добавьте специи, сформируйте котлеты.\n2. Обжарьте котлеты по 5 минут с каждой стороны.\n3. Сварите картофель, разомните с молоком.\n4. Подавайте котлеты с пюре.",
        allergens: ["Молоко"]
    },
    {
        name: "Треска с лимоном и травами",
        ingredients: "Треска (150 г), Лимон (20 г), Травы (5 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 250, "Магнит": 260, "Лента": 240 },
        weight: 200,
        calories: 200,
        protein: 25,
        fat: 8,
        carbs: 2,
        image_url: "https://example.com/cod_lemon.jpg",
        mealType: "горячее",
        recipe: "1. Замаринуйте треску в оливковом масле, лимонном соке и травах.\n2. Запекайте при 180°C 15 минут.\n3. Подавайте с долькой лимона.",
        allergens: ["Рыба"]
    },
    {
        name: "Пад Тай с креветками",
        ingredients: "Рисовая лапша (100 г), Креветки (100 г), Арахис (20 г), Соевый соус (20 мл)",
        prices: { "Пятёрочка": 300, "Магнит": 310, "Лента": 290 },
        weight: 300,
        calories: 450,
        protein: 25,
        fat: 15,
        carbs: 55,
        image_url: "https://example.com/pad_thai.jpg",
        mealType: "горячее",
        recipe: "1. Замочите рисовую лапшу в тёплой воде на 10 минут.\n2. Обжарьте креветки на сковороде.\n3. Добавьте лапшу, соевый соус и арахис, готовьте 5 минут.\n4. Подавайте горячим.",
        allergens: ["Морепродукты", "Орехи", "Соя"]
    },
    {
        name: "Боул с тофу и овощами",
        ingredients: "Тофу (100 г), Рис (50 г), Авокадо (50 г), Овощи (100 г)",
        prices: { "Пятёрочка": 200, "Магнит": 210, "Лента": 195 },
        weight: 300,
        calories: 350,
        protein: 15,
        fat: 15,
        carbs: 40,
        image_url: "https://example.com/tofu_bowl.jpg",
        mealType: "горячее",
        recipe: "1. Сварите рис в подсоленной воде.\n2. Обжарьте тофу на сковороде до золотистой корочки.\n3. Нарежьте авокадо и овощи.\n4. Соберите боул: рис, тофу, авокадо и овощи.",
        allergens: ["Соя"]
    },
    {
        name: "Шакшука",
        ingredients: "Яйца (2 шт), Помидоры (100 г), Перец (50 г), Лук (30 г), Специи",
        prices: { "Пятёрочка": 120, "Магнит": 130, "Лента": 115 },
        weight: 200,
        calories: 200,
        protein: 12,
        fat: 10,
        carbs: 15,
        image_url: "https://example.com/shakshuka.jpg",
        mealType: "завтрак",
        recipe: "1. Нарежьте лук, перец и помидоры.\n2. Обжарьте лук и перец на сковороде 5 минут.\n3. Добавьте помидоры и специи, тушите 10 минут.\n4. Сделайте углубления, вбейте яйца, готовьте 5 минут.",
        allergens: ["Яйца"]
    },
    {
        name: "Буррито с фасолью и овощами",
        ingredients: "Тортилья (1 шт), Фасоль (100 г), Овощи (100 г), Сальса (20 г)",
        prices: { "Пятёрочка": 180, "Магнит": 190, "Лента": 175 },
        weight: 300,
        calories: 400,
        protein: 15,
        fat: 10,
        carbs: 60,
        image_url: "https://example.com/bean_burrito.jpg",
        mealType: "горячее",
        recipe: "1. Обжарьте овощи на сковороде.\n2. Добавьте фасоль и сальсу, тушите 5 минут.\n3. Выложите начинку на тортилью.\n4. Заверните и подавайте.",
        allergens: ["Глютен"]
    },
    {
        name: "Салат с рукколой и грушей",
        ingredients: "Руккола (50 г), Груша (50 г), Грецкие орехи (20 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 130, "Магнит": 140, "Лента": 125 },
        weight: 130,
        calories: 200,
        protein: 3,
        fat: 15,
        carbs: 15,
        image_url: "https://example.com/arugula_pear_salad.jpg",
        mealType: "салат",
        recipe: "1. Порвите рукколу на кусочки.\n2. Нарежьте грушу тонкими ломтиками.\n3. Добавьте грецкие орехи, полейте оливковым маслом.\n4. Перемешайте и подавайте.",
        allergens: ["Орехи"]
    },
    {
        name: "Салат с кальмаром и овощами",
        ingredients: "Кальмар (100 г), Огурец (50 г), Помидоры (50 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 200, "Магнит": 210, "Лента": 195 },
        weight: 210,
        calories: 150,
        protein: 15,
        fat: 5,
        carbs: 10,
        image_url: "https://example.com/squid_salad.jpg",
        mealType: "салат",
        recipe: "1. Отварите кальмар 2-3 минуты, нарежьте кольцами.\n2. Нарежьте огурец и помидоры.\n3. Смешайте кальмар с овощами, полейте оливковым маслом.\n4. Перемешайте и подавайте.",
        allergens: ["Морепродукты"]
    },
    {
        name: "Крем-суп из цветной капусты",
        ingredients: "Цветная капуста (150 г), Картофель (50 г), Сливки (50 мл), Лук (30 г)",
        prices: { "Пятёрочка": 130, "Магнит": 140, "Лента": 125 },
        weight: 300,
        calories: 180,
        protein: 5,
        fat: 8,
        carbs: 20,
        image_url: "https://example.com/cauliflower_soup.jpg",
        mealType: "суп",
        recipe: "1. Обжарьте лук до мягкости.\n2. Добавьте цветную капусту и картофель, варите 15 минут.\n3. Добавьте сливки, взбейте блендером.\n4. Приправьте солью и перцем.",
        allergens: ["Молоко"]
    },
    {
        name: "Суп с чечевицей",
        ingredients: "Чечевица (100 г), Морковь (50 г), Лук (30 г), Специи",
        prices: { "Пятёрочка": 120, "Магнит": 130, "Лента": 115 },
        weight: 300,
        calories: 200,
        protein: 10,
        fat: 2,
        carbs: 35,
        image_url: "https://example.com/lentil_soup.jpg",
        mealType: "суп",
        recipe: "1. Обжарьте лук и морковь.\n2. Добавьте чечевицу и специи, залейте водой.\n3. Варите 20 минут до готовности чечевицы.\n4. Приправьте солью.",
        allergens: []
    },
    {
        name: "Запечённый батат с розмарином",
        ingredients: "Батат (150 г), Розмарин (5 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 100, "Магнит": 110, "Лента": 95 },
        weight: 160,
        calories: 200,
        protein: 3,
        fat: 5,
        carbs: 35,
        image_url: "https://example.com/sweet_potato.jpg",
        mealType: "ужин",
        recipe: "1. Нарежьте батат дольками.\n2. Смешайте с оливковым маслом и розмарином.\n3. Запекайте при 200°C 25 минут.\n4. Подавайте горячим.",
        allergens: []
    },
    {
        name: "Овощной суп с киноа",
        ingredients: "Киноа (50 г), Брокколи (50 г), Морковь (50 г), Лук (30 г)",
        prices: { "Пятёрочка": 130, "Магнит": 140, "Лента": 125 },
        weight: 300,
        calories: 150,
        protein: 5,
        fat: 2,
        carbs: 25,
        image_url: "https://example.com/quinoa_veggie_soup.jpg",
        mealType: "суп",
        recipe: "1. Обжарьте лук и морковь.\n2. Добавьте брокколи и киноа, залейте водой.\n3. Варите 15 минут.\n4. Приправьте солью и перцем.",
        allergens: []
    },
    {
        name: "Куриные наггетсы с соусом",
        ingredients: "Куриное филе (150 г), Панировочные сухари (20 г), Йогуртовый соус (20 г)",
        prices: { "Пятёрочка": 200, "Магнит": 210, "Лента": 195 },
        weight: 200,
        calories: 350,
        protein: 25,
        fat: 15,
        carbs: 20,
        image_url: "https://example.com/chicken_nuggets.jpg",
        mealType: "горячее",
        recipe: "1. Нарежьте куриное филе на кусочки.\n2. Обваляйте в панировочных сухарях.\n3. Обжарьте на сковороде 5-7 минут.\n4. Подавайте с йогуртовым соусом.",
        allergens: ["Глютен", "Молоко"]
    },
    {
        name: "Печеные яблоки с орехами",
        ingredients: "Яблоко (200 г), Грецкие орехи (20 г), Мед (10 г), Корица (2 г)",
        prices: { "Пятёрочка": 60, "Магнит": 65, "Лента": 55 },
        weight: 230,
        calories: 200,
        protein: 2,
        fat: 8,
        carbs: 35,
        image_url: "https://example.com/baked_apples_nuts.jpg",
        mealType: "десерт",
        recipe: "1. Разрежьте яблоко пополам, удалите сердцевину.\n2. Положите грецкие орехи в углубление, полейте мёдом, посыпьте корицей.\n3. Запекайте при 180°C 20 минут.\n4. Подавайте тёплым.",
        allergens: ["Орехи"]
    },
    {
        name: "Йогуртовый десерт с гранолой",
        ingredients: "Йогурт (150 г), Гранола (30 г), Ягоды (50 г)",
        prices: { "Пятёрочка": 100, "Магнит": 110, "Лента": 95 },
        weight: 230,
        calories: 250,
        protein: 8,
        fat: 8,
        carbs: 35,
        image_url: "https://example.com/yogurt_granola.jpg",
        mealType: "десерт",
        recipe: "1. Положите йогурт в миску.\n2. Добавьте гранолу и ягоды сверху.\n3. Подавайте сразу.",
        allergens: ["Молоко", "Глютен", "Орехи"]
    },
    {
        name: "Кокосовые шарики",
        ingredients: "Кокосовая стружка (50 г), Мед (20 г), Миндаль (20 г)",
        prices: { "Пятёрочка": 80, "Магнит": 85, "Лента": 75 },
        weight: 90,
        calories: 200,
        protein: 3,
        fat: 15,
        carbs: 15,
        image_url: "https://example.com/coconut_balls.jpg",
        mealType: "десерт",
        recipe: "1. Измельчите миндаль.\n2. Смешайте кокосовую стружку, мёд и миндаль.\n3. Сформируйте шарики.\n4. Охладите 30 минут в холодильнике.",
        allergens: ["Орехи"]
    },
    {
        name: "Смузи-боул с ягодами",
        ingredients: "Ягоды (100 г), Банан (50 г), Йогурт (100 г), Гранола (20 г)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 270,
        calories: 300,
        protein: 8,
        fat: 5,
        carbs: 50,
        image_url: "https://example.com/smoothie_bowl.jpg",
        mealType: "завтрак",
        recipe: "1. Взбейте ягоды, банан и йогурт в блендере.\n2. Перелейте в миску.\n3. Добавьте гранолу сверху.\n4. Подавайте сразу.",
        allergens: ["Молоко", "Глютен", "Орехи"]
    },
    {
        name: "Тост с рикоттой и ягодами",
        ingredients: "Хлеб цельнозерновой (1 ломтик), Рикотта (50 г), Ягоды (50 г), Мед (10 г)",
        prices: { "Пятёрочка": 100, "Магнит": 110, "Лента": 95 },
        weight: 160,
        calories: 250,
        protein: 8,
        fat: 10,
        carbs: 30,
        image_url: "https://example.com/ricotta_toast.jpg",
        mealType: "завтрак",
        recipe: "1. Поджарьте хлеб в тостере.\n2. Намажьте рикотту на тост.\n3. Выложите ягоды сверху, полейте мёдом.\n4. Подавайте сразу.",
        allergens: ["Глютен", "Молоко"]
    },
    {
        name: "Кесадилья с сыром и овощами",
        ingredients: "Тортилья (1 шт), Сыр (50 г), Перец (50 г), Помидоры (50 г)",
        prices: { "Пятёрочка": 150, "Магнит": 160, "Лента": 145 },
        weight: 200,
        calories: 350,
        protein: 15,
        fat: 15,
        carbs: 40,
        image_url: "https://example.com/quesadilla.jpg",
        mealType: "горячее",
        recipe: "1. Нарежьте перец и помидоры.\n2. Выложите сыр и овощи на половину тортильи.\n3. Сложите тортилью пополам, обжарьте на сковороде по 2 минуты с каждой стороны.\n4. Нарежьте и подавайте.",
        allergens: ["Глютен", "Молоко"]
    },
    {
        name: "Салат с фетой и арбузом",
        ingredients: "Арбуз (100 г), Фета (50 г), Мята (5 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 120, "Магнит": 130, "Лента": 115 },
        weight: 165,
        calories: 200,
        protein: 5,
        fat: 15,
        carbs: 15,
        image_url: "https://example.com/watermelon_feta_salad.jpg",
        mealType: "салат",
        recipe: "1. Нарежьте арбуз и фету кубиками.\n2. Добавьте листья мяты.\n3. Полейте оливковым маслом.\n4. Перемешайте и подавайте.",
        allergens: ["Молоко"]
    },
    {
        name: "Запечённый лосось с лимоном",
        ingredients: "Лосось (150 г), Лимон (20 г), Травы (5 г), Оливковое масло (10 г)",
        prices: { "Пятёрочка": 300, "Магнит": 310, "Лента": 290 },
        weight: 200,
        calories: 300,
        protein: 30,
        fat: 20,
        carbs: 2,
        image_url: "https://example.com/baked_salmon.jpg",
        mealType: "ужин",
        recipe: "1. Замаринуйте лосось в оливковом масле, лимонном соке и травах.\n2. Запекайте при 180°C 15 минут.\n3. Подавайте с долькой лимона.",
        allergens: ["Рыба"]
    },
    {
        name: "Кабачки, фаршированные овощами",
        ingredients: "Кабачок (150 г), Перец (50 г), Помидоры (50 г), Сыр (20 г)",
        prices: { "Пятёрочка": 130, "Магнит": 140, "Лента": 125 },
        weight: 270,
        calories: 150,
        protein: 5,
        fat: 5,
        carbs: 20,
        image_url: "https://example.com/stuffed_zucchini.jpg",
        mealType: "ужин",
        recipe: "1. Разрежьте кабачок пополам, выньте мякоть.\n2. Нарежьте перец и помидоры, смешайте с мякотью кабачка.\n3. Нафаршируйте кабачки, посыпьте сыром.\n4. Запекайте при 180°C 25 минут.",
        allergens: ["Молоко"]
    },
    {
        name: "Гранола с йогуртом",
        ingredients: "Гранола (50 г), Йогурт (150 г), Мед (10 г)",
        prices: { "Пятёрочка": 100, "Магнит": 110, "Лента": 95 },
        weight: 210,
        calories: 300,
        protein: 10,
        fat: 10,
        carbs: 40,
        image_url: "https://example.com/granola_yogurt.jpg",
        mealType: "перекус",
        recipe: "1. Положите йогурт в миску.\n2. Добавьте гранолу сверху.\n3. Полейте мёдом и подавайте.",
        allergens: ["Молоко", "Глютен", "Орехи"]
    },
    {
        name: "Овсяное печенье",
        ingredients: "Овсяные хлопья (50 г), Банан (50 г), Мед (10 г), Изюм (20 г)",
        prices: { "Пятёрочка": 60, "Магнит": 65, "Лента": 55 },
        weight: 130,
        calories: 200,
        protein: 5,
        fat: 5,
        carbs: 35,
        image_url: "https://example.com/oatmeal_cookies.jpg",
        mealType: "десерт",
        recipe: "1. Разомните банан вилкой.\n2. Смешайте банан, овсяные хлопья, мёд и изюм.\n3. Сформируйте печенье и выложите на противень.\n4. Запекайте при 180°C 15 минут.",
        allergens: ["Глютен"]
    }
];

// Функция для расчёта дневной нормы калорий (по формуле Миффлина-Сан Жеора)
function calculateDailyCalories(height, weight, goal) {
    // Базовый расчёт для мужчины (можно добавить пол в userData для точности)
    const bmr = 10 * weight + 6.25 * height - 5 * 30 + 5; // Предполагаем возраст 30
    let dailyCalories = bmr * 1.5; // Умножаем на коэффициент активности (средний уровень)

    // Корректировка в зависимости от цели
    if (goal === "похудение") {
        dailyCalories -= 500; // Дефицит 500 ккал для похудения
    } else if (goal === "массонабор") {
        dailyCalories += 500; // Профицит 500 ккал для массонабора
    }

    return Math.round(dailyCalories);
}

// Функция для расчёта макронутриентов (примерное распределение: 30% белки, 30% жиры, 40% углеводы)
function calculateMacros(calories) {
    const protein = Math.round((calories * 0.3) / 4); // 1 г белка = 4 ккал
    const fat = Math.round((calories * 0.3) / 9); // 1 г жира = 9 ккал
    const carbs = Math.round((calories * 0.4) / 4); // 1 г углеводов = 4 ккал
    return { protein, fat, carbs };
}

// Функция для фильтрации блюд по аллергиям
function filterDishesByAllergies(dishes, allergies) {
    return dishes.filter(dish => {
        return !dish.allergens.some(allergen => allergies.includes(allergen));
    });
}

// Функция для составления меню на день
function generateDailyMenu(dailyCalories, dailyMacros, allergies) {
    const filteredDishes = filterDishesByAllergies(dishes, allergies);
    const mealTypes = ["завтрак", "перекус", "суп", "горячее", "салат", "ужин", "десерт", "напиток"];
    let menu = [];
    let totalCalories = 0;
    let totalMacros = { protein: 0, fat: 0, carbs: 0 };

    // Для каждого типа приёма пищи выбираем одно блюдо
    mealTypes.forEach(mealType => {
        const availableDishes = filteredDishes.filter(dish => dish.mealType === mealType);
        if (availableDishes.length === 0) return;

        // Выбираем случайное блюдо
        const dish = availableDishes[Math.floor(Math.random() * availableDishes.length)];

        // Проверяем, чтобы не превысить дневную норму калорий
        if (totalCalories + dish.calories <= dailyCalories * 1.1) { // Допускаем небольшой перебор
            menu.push({ mealType, dish });
            totalCalories += dish.calories;
            totalMacros.protein += dish.protein;
            totalMacros.fat += dish.fat;
            totalMacros.carbs += dish.carbs;
        }
    });

    return { menu, totalCalories, totalMacros };
}

// Функция для отображения меню на вкладке "Сегодня"
function displayMenu() {
    const menuContainer = document.getElementById("menu-list");
    menuContainer.innerHTML = ""; // Очищаем контейнер

    const dailyCalories = userData.dailyCalories;
    const dailyMacros = userData.dailyMacros;
    const allergies = userData.allergies;

    const { menu, totalCalories, totalMacros } = generateDailyMenu(dailyCalories, dailyMacros, allergies);
    userData.menu = menu; // Сохраняем меню в userData

    // Отображаем общее количество калорий и макронутриентов
    const summary = document.createElement("div");
    summary.className = "menu-summary";
    summary.innerHTML = `
        <h3>Итого за день</h3>
        <p>Калории: ${totalCalories} / ${dailyCalories} ккал</p>
        <p>Белки: ${totalMacros.protein} / ${dailyMacros.protein} г</p>
        <p>Жиры: ${totalMacros.fat} / ${dailyMacros.fat} г</p>
        <p>Углеводы: ${totalMacros.carbs} / ${dailyMacros.carbs} г</p>
    `;
    menuContainer.appendChild(summary);

    // Отображаем каждое блюдо
    menu.forEach(item => {
        const mealDiv = document.createElement("div");
        mealDiv.className = "menu-item";

        // Переводим тип блюда на русский
        const mealTypeNames = {
            "завтрак": "Завтрак",
            "перекус": "Перекус",
            "суп": "Суп",
            "горячее": "Горячее",
            "салат": "Салат",
            "ужин": "Ужин",
            "десерт": "Десерт",
            "напиток": "Напиток"
        };

        mealDiv.innerHTML = `
            <h3>${mealTypeNames[item.mealType]}</h3>
            <div class="dish-card">
                <img src="${item.dish.image_url}" alt="${item.dish.name}" class="dish-image">
                <div class="dish-info">
                    <h4>${item.dish.name}</h4>
                    <p>Калории: ${item.dish.calories} ккал</p>
                    <p>Белки: ${item.dish.protein} г, Жиры: ${item.dish.fat} г, Углеводы: ${item.dish.carbs} г</p>
                    <p>Ингредиенты: ${item.dish.ingredients}</p>
                    <p>Цены: Пятёрочка: ${item.dish.prices["Пятёрочка"]} ₽, Магнит: ${item.dish.prices["Магнит"]} ₽, Лента: ${item.dish.prices["Лента"]} ₽</p>
                    <button class="details-btn" data-dish='${JSON.stringify(item.dish)}'>Подробнее</button>
                </div>
            </div>
        `;
        menuContainer.appendChild(mealDiv);
    });

    // Добавляем обработчики событий для кнопок "Подробнее"
    document.querySelectorAll(".details-btn").forEach(button => {
        button.addEventListener("click", (e) => {
            const dish = JSON.parse(e.target.getAttribute("data-dish"));
            showDishDetails(dish);
        });
    });
}

// Функция для отображения деталей блюда в модальном окне
function showDishDetails(dish) {
    const modal = document.createElement("div");
    modal.className = "modal";
    modal.innerHTML = `
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>${dish.name}</h2>
            <img src="${dish.image_url}" alt="${dish.name}" class="modal-image">
            <p><strong>Калории:</strong> ${dish.calories} ккал</p>
            <p><strong>Белки:</strong> ${dish.protein} г</p>
            <p><strong>Жиры:</strong> ${dish.fat} г</p>
            <p><strong>Углеводы:</strong> ${dish.carbs} г</p>
            <p><strong>Вес:</strong> ${dish.weight} г</p>
            <p><strong>Ингредиенты:</strong> ${dish.ingredients}</p>
            <p><strong>Цены:</strong> Пятёрочка: ${dish.prices["Пятёрочка"]} ₽, Магнит: ${dish.prices["Магнит"]} ₽, Лента: ${dish.prices["Лента"]} ₽</p>
            <p><strong>Рецепт:</strong></p>
            <pre>${dish.recipe}</pre>
        </div>
    `;
    document.body.appendChild(modal);

    // Закрытие модального окна
    modal.querySelector(".close-btn").addEventListener("click", () => {
        modal.remove();
    });

    // Закрытие при клике вне модального окна
    modal.addEventListener("click", (e) => {
        if (e.target === modal) {
            modal.remove();
        }
    });
}

// Функция для отображения вкладки "Сегодня"
function showTodayTab() {
    document.getElementById("today-tab").style.display = "block";
    document.getElementById("progress-tab").style.display = "none";
    document.getElementById("achievements-tab").style.display = "none";
    document.getElementById("settings-tab").style.display = "none";

    // Обновляем меню
    displayMenu();
}

// Функция для отображения вкладки "Прогресс"
function showProgressTab() {
    document.getElementById("today-tab").style.display = "none";
    document.getElementById("progress-tab").style.display = "block";
    document.getElementById("achievements-tab").style.display = "none";
    document.getElementById("settings-tab").style.display = "none";

    // Обновляем данные прогресса
    document.getElementById("water-intake").textContent = userData.water;
    document.getElementById("steps-count").textContent = userData.steps;

    // Обновляем график веса
    updateWeightChart();
}

// Функция для отображения вкладки "Достижения"
function showAchievementsTab() {
    document.getElementById("today-tab").style.display = "none";
    document.getElementById("progress-tab").style.display = "none";
    document.getElementById("achievements-tab").style.display = "block";
    document.getElementById("settings-tab").style.display = "none";

    // Обновляем достижения
    const achievementsList = document.getElementById("achievements-list");
    achievementsList.innerHTML = "";
    userData.achievements.forEach(achievement => {
        const li = document.createElement("li");
        li.textContent = achievement;
        achievementsList.appendChild(li);
    });
}

// Функция для отображения вкладки "Настройки"
function showSettingsTab() {
    document.getElementById("today-tab").style.display = "none";
    document.getElementById("progress-tab").style.display = "none";
    document.getElementById("achievements-tab").style.display = "none";
    document.getElementById("settings-tab").style.display = "block";
}

// Функция для обновления графика веса
function updateWeightChart() {
    const ctx = document.getElementById("weight-chart").getContext("2d");
    new Chart(ctx, {
        type: "line",
        data: {
            labels: userData.weightHistory.map((_, index) => `День ${index + 1}`),
            datasets: [{
                label: "Вес (кг)",
                data: userData.weightHistory,
                borderColor: "rgba(75, 192, 192, 1)",
                fill: false
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: false
                }
            }
        }
    });
}

// Обработчики событий для навигации
document.getElementById("today-btn").addEventListener("click", showTodayTab);
document.getElementById("progress-btn").addEventListener("click", showProgressTab);
document.getElementById("achievements-btn").addEventListener("click", showAchievementsTab);
document.getElementById("settings-btn").addEventListener("click", showSettingsTab);

// Обработчик для добавления воды
document.getElementById("add-water-btn").addEventListener("click", () => {
    userData.water += 200; // Добавляем 200 мл
    document.getElementById("water-intake").textContent = userData.water;
    userData.points += 10; // Начисляем очки
});

// Обработчик для добавления шагов
document.getElementById("add-steps-btn").addEventListener("click", () => {
    userData.steps += 1000; // Добавляем 1000 шагов
    document.getElementById("steps-count").textContent = userData.steps;
    userData.points += 20; // Начисляем очки

    // Проверяем достижение
    if (userData.steps >= 10000 && !userData.achievements.includes("10 000 шагов")) {
        userData.achievements.push("10 000 шагов");
        alert("Поздравляем! Вы достигли 10 000 шагов!");
    }
});

// Обработчик для формы онбординга
document.getElementById("onboarding-form").addEventListener("submit", (e) => {
    e.preventDefault();
    userData.height = parseInt(document.getElementById("height").value);
    userData.weight = parseInt(document.getElementById("weight").value);
    userData.goal = document.getElementById("goal").value;
    userData.allergies = Array.from(document.getElementById("allergies").selectedOptions).map(option => option.value);

    // Рассчитываем дневные нормы
    userData.dailyCalories = calculateDailyCalories(userData.height, userData.weight, userData.goal);
    userData.dailyMacros = calculateMacros(userData.dailyCalories);

    // Скрываем онбординг и показываем основное приложение
    document.getElementById("onboarding").style.display = "none";
    document.getElementById("app").style.display = "block";

    // Показываем вкладку "Сегодня" по умолчанию
    showTodayTab();
});

// Инициализация приложения
document.addEventListener("DOMContentLoaded", () => {
    // Проверяем, есть ли данные пользователя (например, из localStorage)
    // Если данных нет, показываем онбординг
    document.getElementById("onboarding").style.display = "block";
    document.getElementById("app").style.display = "none";
});
